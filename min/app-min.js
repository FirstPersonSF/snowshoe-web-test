var express=require("express"),path=require("path"),favicon=require("serve-favicon"),morgan=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),mongoose=require("mongoose"),uriUtil=require("mongodb-uri"),mongooseOptions={server:{socketOptions:{keepAlive:1,connectTimeoutMS:3e4}},replset:{socketOptions:{keepAlive:1,connectTimeoutMS:3e4}}},mongodbUri=process.env.MONGODB_URI||process.env.MONGOLAB_URI,mongooseUri=uriUtil.formatMongoose(mongodbUri);mongoose.connect(mongooseUri,mongooseOptions),require("./app/models/index");var app=express();app.use(morgan("dev")),app.use(bodyParser.json({limit:"10mb"})),app.use(bodyParser.urlencoded({extended:!1})),app.use(cookieParser()),app.use(express["static"](path.join(__dirname,"public")));var apiV1Route=require("./app/routes/apiV1");app.use("/api/v1/",apiV1Route);var defaultRoute=require("./app/routes/default");app.use("/",defaultRoute),"development"===app.get("env")&&app.use(function(e,o,r,s){r.status(e.status||500),r.json({message:e.message,error:e})}),app.use(function(e,o,r,s){r.status(e.status||500),r.json({message:e.message})}),module.exports=app;